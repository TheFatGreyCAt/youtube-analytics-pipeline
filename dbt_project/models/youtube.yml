version: 2

# Simple model documentation following Fivetran dbt package style
# No auto-generation - models are written manually

models:
  - name: stg_youtube__videos
    description: |
      Staging model for YouTube videos - flattens raw JSON data into relational format.
      
      **Source:** youtube_videos_raw
      **Grain:** One row per video
    
    columns:
      - name: video_id
        description: Unique video identifier (Primary Key)
        tests:
          - unique
          - not_null
      
      - name: channel_id
        description: Foreign key to channels
        tests:
          - not_null
          - relationships:
              to: ref('stg_youtube__channels')
              field: channel_id
      
      - name: title
        description: Video title
        tests:
          - not_null
      
      - name: description
        description: Video description
      
      - name: tags
        description: Array of video tags
      
      - name: category_id
        description: YouTube category ID
      
      - name: published_at
        description: Video publish timestamp
        tests:
          - not_null
      
      - name: view_count
        description: Total view count
        tests:
          - not_null
      
      - name: like_count
        description: Total like count (nullable if disabled)
      
      - name: comment_count
        description: Total comment count (nullable if disabled)
      
      - name: duration_iso8601
        description: Video duration in ISO 8601 format (e.g., PT15M30S)
        tests:
          - not_null
      
      - name: has_caption
        description: Whether video has captions
      
      - name: definition
        description: Video quality (hd/sd)
      
      - name: privacy_status
        description: Privacy status (public/private/unlisted)
        tests:
          - accepted_values:
              values: ['public']
      
      - name: is_embeddable
        description: Whether video can be embedded
      
      - name: is_made_for_kids
        description: COPPA compliance flag
      
      - name: crawled_at
        description: Timestamp when data was crawled
        tests:
          - not_null

  - name: stg_youtube__channels
    description: |
      Staging model for YouTube channels - flattens raw JSON data.
      
      **Source:** youtube_channels_raw
      **Grain:** One row per channel
    
    columns:
      - name: channel_id
        description: Unique channel identifier (Primary Key)
        tests:
          - unique
          - not_null
      
      - name: channel_name
        description: Channel name/title
        tests:
          - not_null
      
      - name: description
        description: Channel description
      
      - name: channel_created_at
        description: Channel creation timestamp
        tests:
          - not_null
      
      - name: country_code
        description: Country code (e.g., US, VN)
      
      - name: subscriber_count
        description: Total subscribers (can be hidden)
        tests:
          - not_null
      
      - name: total_view_count
        description: Total views across all videos
        tests:
          - not_null
      
      - name: video_count
        description: Number of public videos
        tests:
          - not_null
      
      - name: uploads_playlist_id
        description: Playlist ID containing all uploads
      
      - name: topic_ids
        description: Array of topic IDs for categorization
      
      - name: crawled_at
        description: Timestamp when data was crawled
        tests:
          - not_null

  - name: stg_youtube__playlists
    description: |
      Staging model for YouTube playlists - flattens raw JSON data.
      
      **Source:** youtube_playlists_raw
      **Grain:** One row per playlist
    
    columns:
      - name: playlist_id
        description: Unique playlist identifier (Primary Key)
        tests:
          - unique
          - not_null
      
      - name: channel_id
        description: Foreign key to channels
        tests:
          - not_null
          - relationships:
              to: ref('stg_youtube__channels')
              field: channel_id
      
      - name: playlist_name
        description: Playlist title
        tests:
          - not_null
      
      - name: description
        description: Playlist description
      
      - name: created_at
        description: Playlist creation timestamp
        tests:
          - not_null
      
      - name: item_count
        description: Number of videos in playlist
        tests:
          - not_null
      
      - name: privacy_status
        description: Privacy status (public/private/unlisted)
        tests:
          - accepted_values:
              values: ['public']
      
      - name: crawled_at
        description: Timestamp when data was crawled
        tests:
          - not_null