version: 2

models:
  - name: int_videos__enhanced
    description: Videos enriched with channel context and derived temporal fields
    columns:
      - name: video_id
        tests:
          - unique
          - not_null
      - name: channel_id
        tests:
          - not_null
      - name: duration_seconds
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 360000
      - name: video_length_category
        tests:
          - accepted_values:
              arguments:
                values: ['shorts', 'short', 'medium', 'long']

  - name: int_engagement_metrics
    description: Calculated engagement metrics per video
    columns:
      - name: video_id
        tests:
          - unique
          - not_null
      - name: engagement_score
        tests:
          - not_null
      - name: engagement_level
        tests:
          - accepted_values:
              arguments:
                values: ['high', 'medium', 'low']

  - name: int_channel_summary
    description: Aggregated channel-level statistics
    columns:
      - name: channel_id
        tests:
          - unique
          - not_null
      - name: total_videos_crawled
        tests:
          - not_null
      - name: latest_video_date
        description: Date (not timestamp) of most recent video — used by dim_channel_summary for DATE_DIFF
        tests:
          - not_null
      - name: earliest_video_date
        description: Date (not timestamp) of oldest video — used by dim_channel_summary for DATE_DIFF
        tests:
          - not_null
